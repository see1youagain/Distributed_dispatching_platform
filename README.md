# 分布式货运调度平台

## 项目介绍

本项目旨在设计并实现一个分布式货运调度平台，满足多项功能需求，包括任务分配与监控、插件远程更新、任务迁移等。该平台旨在优化物流任务的调度过程，提高运输效率和资源利用率。

物流公司需要开发一套系统，该系统将支持总部管理中心与多个地区分支进行协作。当有新的运输任务时，总部服务器将任务分配至相应分支，分支机构调度可用车辆进行执行，并反馈任务进度及结果。系统还需要支持任务的迁移、插件更新等动态功能。

## 考查实验要求

某大型物流公司需要开发一套分布式货运调度平台，该平台需要在总部管理中心与多个地区分支之间协作。平台主要包含以下几个要求：

1. **任务分配与监控**：总部管理中心负责任务的统一管理和分配。每个分支机构会根据任务要求调度车辆（>=2辆）执行运输任务。分支机构在执行过程中需要实时将任务进展汇报给总部。

2. **插件远程更新**：调度中心需支持通过远程更新方式，对分支机构的调度系统进行功能扩展。例如，若有新的物流路线需求，系统能够动态下发模块更新包。

3. **任务迁移**：当某个分支机构因车辆资源达到上限时，平台应支持将任务迁移至其他分支。若所有分支均达到上限，则调度系统将等待任一分支完成任务后再进行任务分配。

## 实验分析

### **实验目的**
1. 理解并实践分布式系统的架构设计。
2. 掌握 Socket 通信技术在任务分配与反馈中的应用。
3. 学习插件动态加载与更新技术。
4. 实现任务迁移的序列化与反序列化技术。

### **任务重点**
1. **调度中心**
   - 管理任务队列，分配任务给不同的分支机构。
   - 实时监控各分支机构的任务进展，生成任务执行报告。

2. **分支机构**
   - 接收任务，调度可用车辆执行任务。
   - 汇报任务执行进度，并支持任务迁移。

3. **插件更新**
   - 动态加载插件以扩展系统功能，例如支持新的物流路线。

4. **任务迁移**
   - 实现任务的动态迁移，以应对分支机构资源上限。

### **实现思路**
1. **类设计**
   - **调度中心类 (`LogisticsCenter`)**：负责任务分配与任务进展监控。
   - **分支机构类 (`BranchOffice`)**：处理任务接收、车辆调度、进度反馈等。
   - **任务类 (`Task`)**：存储任务信息，管理任务状态。
   - **车辆类 (`Vehicle`)**：管理车辆信息与调度。
   - **插件管理类 (`PluginManager`)**：支持插件的动态加载和更新。
   - **任务迁移类 (`TaskMigrator`)**：支持任务序列化与反序列化，进行任务迁移。

2. **通信方式**
   - 使用异步的 **Socket 通信**，实现调度中心与各分支机构之间的任务分配、任务结果反馈、插件更新等。

3. **功能扩展**
   - **插件更新**：通过插件机制动态扩展系统功能。
   - **任务迁移**：通过序列化技术在分支机构之间迁移任务，避免资源超载。

### **建议实现步骤**
1. **搭建基础框架**
   - 设计类图和模块功能。
   - 确定任务流路径，例如从调度中心到分支机构的任务流动路径。

2. **实现异步通信**
   - 服务器端负责监听任务请求并响应。
   - 客户端执行任务并向调度中心反馈执行结果。

3. **插件管理与任务迁移**
   - 实现插件的动态加载和更新。
   - 完成任务的序列化与反序列化，以支持任务迁移。

4. **整合与测试**
   - 模拟任务场景，测试调度与反馈机制。
   - 测试插件加载和任务迁移功能。

5. **优化**
   - 优化网络通信，提升系统性能。
   - 增强任务调度算法，例如根据任务优先级动态调度。

## 项目架构

以下是项目的目录结构，详细列出了各模块及文件：

```bash
Distributed_dispatching_platform/
│
├── core/                     # 核心模块：负责平台的主要业务逻辑，包括任务调度、分支机构管理、任务与车辆的处理等。
│   ├── LogisticsCenter.cpp   # 调度中心核心逻辑：负责管理任务、监控任务进度、分配任务给各分支机构。
│   ├── LogisticsCenter.h     # 调度中心头文件：声明调度中心的各类函数与成员变量。
│   ├── BranchOffice.cpp      # 分支机构逻辑：负责处理调度中心分配的任务，并调度可用的车辆执行任务。
│   ├── BranchOffice.h        # 分支机构头文件：声明分支机构的各类函数与成员变量。
│   ├── Task.cpp              # 任务类逻辑：任务的具体实现，包括任务的属性、处理方式等。
│   ├── Task.h                # 任务类头文件：声明任务类的函数与成员变量。
│   ├── Vehicle.cpp           # 车辆类逻辑：负责车辆的管理与状态，包括车辆的任务分配与状态更新。
│   ├── Vehicle.h             # 车辆类头文件：声明车辆类的函数与成员变量。
│
├── plugins/                  # 插件模块：支持插件的动态加载与更新，扩展系统的功能。
│   ├── PluginManager.cpp     # 插件管理核心逻辑：负责插件的加载、更新和管理。
│   ├── PluginManager.h       # 插件管理头文件：声明插件管理类的函数与成员变量。
│   ├── SamplePlugin.cpp      # 示例插件：示范如何编写和集成插件到系统中。
│   ├── SamplePlugin.h        # 示例插件头文件：声明示例插件的函数与成员变量。
│
├── network/                  # 网络通信模块：实现调度中心与分支机构间的通信。
│   ├── Server.cpp            # 调度中心服务器：实现服务器端功能，处理来自分支的请求。
│   ├── Server.h              # 服务器头文件：声明服务器类的函数与成员变量。
│   ├── Client.cpp            # 分支机构客户端：实现客户端功能，处理来自调度中心的任务。
│   ├── Client.h              # 客户端头文件：声明客户端类的函数与成员变量。
│
├── config/                   # 配置文件：包括系统运行时所需的各种配置文件。
│   ├── center_config/         # 调度中心相关配置
│       ├── config.json  # 配置文件，包含调度中心的基本信息（IP、端口等）。
│       ├── log.txt  # 日志文件，记录系统运行时的日志信息。
│       ├── routes.json  # 路线数据文件，记录各种路线信息。
│       ├── routes_lists/  # 路线版本文件夹，保存不同版本的路线数据。
│           ├── routes_lists_v1.json  # 路线版本1
│           ├── routes_lists_v2.json  # 路线版本2
│   ├── branch_config/         # 分支机构相关配置
│       ├── routes.json  # 路线数据文件，记录分支机构的路线信息。
│       ├── routes_lists/  # 路线版本文件夹
│           ├── routes_lists_v1.json  # 路线版本1
│
├── utils/                    # 工具模块：包含系统所需的工具类，如日志记录、序列化工具等。
│   ├── Logger.cpp            # 日志工具：实现日志记录功能。
│   ├── Logger.h              # 日志头文件：声明日志工具类的函数与成员变量。
│
├── docs/                     # 文档：包含项目的架构文档、使用说明、API 文档等。
│   ├── architecture.md       # 系统架构文档：详细介绍系统的整体架构与模块设计。
│   ├── usage.md              # 使用说明：介绍如何配置和运行项目。
│   ├── api_reference.md      # API 文档：列出系统各个模块的接口说明。
│
├── CMakeLists.txt            # CMake构建文件：用于配置项目的构建流程。
├── README.md                 # 项目介绍：概述项目的目标、功能和使用方式。
└── main.cpp                  # 主程序入口：程序的启动点，初始化并运行系统。
```
